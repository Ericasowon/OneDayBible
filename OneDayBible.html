<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì˜¤ëŠ˜ì˜ ì„±ê²½ í•œ êµ¬ì ˆ</title>
  <meta name="description" content="ë§¤ì¼ ìƒˆë¡œìš´ ì„±ê²½ í•œ êµ¬ì ˆì„ ë³´ì—¬ì£¼ëŠ” ì‘ì€ ì›¹ì‚¬ì´íŠ¸" />
  <meta property="og:title" content="ì˜¤ëŠ˜ì˜ ì„±ê²½ í•œ êµ¬ì ˆ" />
  <meta property="og:description" content="ë§¤ì¼ ìƒˆë¡œìš´ ì„±ê²½ í•œ êµ¬ì ˆì„ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://dummyimage.com/1200x630/eeeeee/111111&text=%EC%98%A4%EB%8A%98%EC%9D%98+%EC%84%B1%EA%B2%BD" />
  <meta name="theme-color" content="#0ea5e9" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ“–</text></svg>">
  <style>
    :root{--bg:#0b1220;--card:#101827;--text:#e5e7eb;--muted:#9ca3af;--accent:#22d3ee;}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,sans-serif;background:linear-gradient(180deg,#0b1220,#0e172a);color:var(--text);display:flex;align-items:center;justify-content:center;padding:24px}
    .wrap{width:100%;max-width:720px}
    .card{background:var(--card);border:1px solid rgba(255,255,255,0.06);border-radius:24px;box-shadow:0 10px 30px rgba(0,0,0,0.35);padding:28px}
    header{display:flex;gap:12px;align-items:center;justify-content:space-between}
    h1{font-size:20px;margin:0;letter-spacing:0.2px}
    .date{font-size:14px;color:var(--muted)}
    blockquote{margin:22px 0 12px;padding:0;font-size:24px;line-height:1.5;letter-spacing:0.2px}
    .ref{color:var(--accent);font-weight:600;margin-top:8px}
    .ver{color:var(--muted);font-size:13px}
    .btns{display:flex;gap:10px;margin-top:18px}
    button{border:1px solid rgba(255,255,255,0.12);background:#0b1220;color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:600}
    button:hover{border-color:rgba(255,255,255,0.28)}
    .tip{margin-top:18px;color:var(--muted);font-size:13px}
    footer{margin-top:26px;font-size:12px;color:var(--muted);display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap}
    a{color:#7dd3fc;text-decoration:none}
    a:hover{text-decoration:underline}
    .credits{opacity:.8}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <h1>ì˜¤ëŠ˜ì˜ ì„±ê²½ í•œ êµ¬ì ˆ</h1>
        <div class="date" id="date"></div>
      </header>

      <blockquote id="verse">ë¡œë”© ì¤‘â€¦</blockquote>
      <div class="ref" id="ref"></div>
      <div class="ver" id="version"></div>

      <div class="btns">
        <button id="copyBtn">êµ¬ì ˆ ë³µì‚¬</button>
        <button id="shareBtn">ê³µìœ í•˜ê¸°</button>
        <button id="refreshBtn" title="í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨">â†» ìƒˆë¡œê³ ì¹¨</button>
      </div>

      <p class="tip">â€» ì„œìš¸ ì‹œê°„(Asia/Seoul) ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œê°€ ë°”ë€Œë©´ ìë™ìœ¼ë¡œ ìƒˆë¡œìš´ êµ¬ì ˆì´ í‘œì‹œë©ë‹ˆë‹¤.</p>

      <footer>
        <span class="credits">Â© <span id="year"></span> ì˜¤ëŠ˜ì˜ ì„±ê²½</span>
        <span>
          <a href="#" id="howLink">ì–´ë–»ê²Œ ì‘ë™í•˜ë‚˜ìš”?</a>
        </span>
      </footer>
    </div>
  </div>

  <dialog id="how">
    <article style="max-width:680px;padding:16px 8px">
      <h3>ì‘ë™ ì›ë¦¬</h3>
      <p>ì´ í˜ì´ì§€ëŠ” <strong>ì„œìš¸ ê¸°ì¤€ ì—°ì¤‘ ëª‡ ë²ˆì§¸ ë‚ (DOY)</strong>ì„ ê³„ì‚°í•´, ê·¸ ê°’ìœ¼ë¡œ êµ¬ì ˆ ëª©ë¡ì—ì„œ í•˜ë‚˜ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. ëª©ë¡ì„ ëŠ˜ë¦¬ë©´ ìë™ìœ¼ë¡œ ì£¼ê¸°ê°€ ê¸¸ì–´ì§‘ë‹ˆë‹¤.</p>
      <ol>
        <li>êµ¬ì ˆ ë°ì´í„°ëŠ” ë³„ë„ì˜ <code>verses.json</code> íŒŒì¼ì— ë“¤ì–´ ìˆìŠµë‹ˆë‹¤.</li>
        <li>ë‚ ì§œê°€ ë°”ë€Œë©´(ìì •) ìƒˆ êµ¬ì ˆì´ ìë™ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤.</li>
        <li>ì¸í„°ë„· ì—°ê²° ì—†ì´ë„ ë™ì‘í•©ë‹ˆë‹¤(ì™¸ë¶€ API ë¯¸ì‚¬ìš©).</li>
      </ol>
      <p>ì›í•˜ì‹œë©´ ê³µê°œ API(ì˜ˆ: bible-api.com ë“±)ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì‰½ê²Œ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      <div style="margin-top:8px"><button onclick="closeHow()">ë‹«ê¸°</button></div>
    </article>
  </dialog>

  <script>
    let VERSES = [];

    function getSeoulNow(){
      const now = new Date();
      const s = now.toLocaleString('sv-SE', { timeZone: 'Asia/Seoul' }).replace(' ', 'T');
      return new Date(s);
    }

    function dayOfYearSeoul(d){
      const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
      const utc = Date.UTC(d.getUTCFullYear(), d.getUTCMonth(), d.getUTCDate());
      return Math.floor((utc - yearStart) / 86400000) + 1;
    }

    function pickVerse(){
      const nowKST = getSeoulNow();
      const doy = dayOfYearSeoul(nowKST);
      const idx = (doy - 1) % VERSES.length;
      return VERSES[idx];
    }

    function render(){
      const nowKST = getSeoulNow();
      const v = pickVerse();
      document.getElementById('date').textContent = nowKST.toLocaleDateString('ko-KR', {
        timeZone: 'Asia/Seoul', year: 'numeric', month: 'long', day: 'numeric', weekday: 'long'
      });
      document.getElementById('verse').textContent = 'â€œ' + v.t + 'â€';
      document.getElementById('ref').textContent = v.r;
      document.getElementById('version').textContent = v.v;
      document.getElementById('year').textContent = nowKST.getFullYear();
      document.title = `${v.r} â€” ì˜¤ëŠ˜ì˜ ì„±ê²½ í•œ êµ¬ì ˆ`;
    }

    async function copyVerse(){
      const v = pickVerse();
      const text = `${v.r} ( ${v.v} )\n\n${v.t}`;
      try{ await navigator.clipboard.writeText(text); alert('êµ¬ì ˆì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.'); }
      catch(e){ prompt('ë³µì‚¬ ì‹¤íŒ¨. ì•„ë˜ ë‚´ìš©ì„ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•˜ì„¸ìš”:', text); }
    }

    async function shareVerse(){
      const v = pickVerse();
      const text = `${v.r} â€” ${v.t}`;
      const shareData = { title: 'ì˜¤ëŠ˜ì˜ ì„±ê²½ í•œ êµ¬ì ˆ', text, url: location.href };
      if(navigator.share){
        try{ await navigator.share(shareData); } catch(e){}
      } else {
        copyVerse();
      }
    }

    function closeHow(){ document.getElementById('how').close(); }
    function openHow(){ document.getElementById('how').showModal(); }

    document.getElementById('copyBtn').addEventListener('click', copyVerse);
    document.getElementById('shareBtn').addEventListener('click', shareVerse);
    document.getElementById('refreshBtn').addEventListener('click', () => location.reload());
    document.getElementById('howLink').addEventListener('click', (e)=>{ e.preventDefault(); openHow(); });

    function scheduleMidnightRefresh(){
      const now = getSeoulNow();
      const next = new Date(now);
      next.setDate(now.getDate() + 1);
      next.setHours(0,0,2,0);
      const ms = next - now;
      setTimeout(() => { render(); scheduleMidnightRefresh(); }, ms);
    }

    async function init(){
      try {
        const res = await fetch('verses.json');
        VERSES = await res.json();
        render();
        scheduleMidnightRefresh();
      } catch (e) {
        document.getElementById('verse').textContent = 'êµ¬ì ˆ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.';
      }
    }

    init();
  </script>
</body>
</html>

